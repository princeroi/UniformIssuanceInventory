<script>
    // Protection for individual page files
    (function() {
        const isLoggedIn = sessionStorage.getItem('isLoggedIn');
        
        if (!isLoggedIn || isLoggedIn !== 'true') {
            // If accessed directly, redirect to login
            window.location.href = '../pages/login.html';
            throw new Error('Not authenticated');
        }
    })();
</script>
<div class="page-header">
    <h1 class="page-title">Reports & Analytics</h1>
    <p class="page-subtitle">Generate and view system reports</p>
</div>

<!-- Report Selection Cards -->
<div class="row g-4 mb-4">
    <div class="col-md-4">
        <div class="card h-100" style="cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''">
            <div class="card-body text-center">
                <div class="mb-3" style="font-size: 3rem; color: #667eea;">
                    <i class="fas fa-boxes"></i>
                </div>
                <h5 class="card-title">Inventory Report</h5>
                <p class="text-muted">Current stock levels and inventory summary</p>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#inventoryReportModal">
                    <i class="fas fa-file-alt"></i> Generate Report
                </button>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100" style="cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''">
            <div class="card-body text-center">
                <div class="mb-3" style="font-size: 3rem; color: #f5576c;">
                    <i class="fas fa-hand-holding"></i>
                </div>
                <h5 class="card-title">Issuance Report</h5>
                <p class="text-muted">Uniform issuance history and statistics</p>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#issuanceReportModal">
                    <i class="fas fa-file-alt"></i> Generate Report
                </button>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100" style="cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 20px rgba(0,0,0,0.15)'" onmouseout="this.style.transform=''; this.style.boxShadow=''">
            <div class="card-body text-center">
                <div class="mb-3" style="font-size: 3rem; color: #00f2fe;">
                    <i class="fas fa-truck"></i>
                </div>
                <h5 class="card-title">Delivery Report</h5>
                <p class="text-muted">Delivery tracking and supplier performance</p>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#deliveryReportModal">
                    <i class="fas fa-file-alt"></i> Generate Report
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Recent Reports -->
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="fas fa-history"></i> Recent Reports</h5>
        <button class="btn btn-sm btn-outline-primary" onclick="loadRecentReports()">
            <i class="fas fa-sync-alt"></i> Refresh
        </button>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Report Name</th>
                        <th>Type</th>
                        <th>Date Generated</th>
                        <th>Generated By</th>
                        <th>Period</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="6" class="text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Loading...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Inventory Report Modal -->
<div class="modal fade" id="inventoryReportModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-boxes"></i> Generate Inventory Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="inventoryReportForm">
                    <div class="mb-3">
                        <label class="form-label">Report Period</label>
                        <select class="form-select" name="period">
                            <option value="current_month">Current Month</option>
                            <option value="last_month">Last Month</option>
                            <option value="last_quarter">Last Quarter</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Category Filter</label>
                        <select class="form-select" name="category">
                            <option value="all">All Categories</option>
                            <option value="Uniforms">Uniforms</option>
                            <option value="Safety Equipment">Safety Equipment</option>
                            <option value="Footwear">Footwear</option>
                            <option value="Accessories">Accessories</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Include</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="include_stock_levels" checked>
                            <label class="form-check-label">Stock Levels</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="include_low_stock" checked>
                            <label class="form-check-label">Low Stock Items</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="include_out_of_stock" checked>
                            <label class="form-check-label">Out of Stock Items</label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Format</label>
                        <select class="form-select" name="format">
                            <option value="pdf">PDF (Print/Preview)</option>
                            <option value="csv">CSV (Excel)</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">
                    <i class="fas fa-file-download"></i> Generate
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Issuance Report Modal -->
<div class="modal fade" id="issuanceReportModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-hand-holding"></i> Generate Issuance Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="issuanceReportForm">
                    <div class="mb-3">
                        <label class="form-label">Date From</label>
                        <input type="date" class="form-control" name="date_from" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Date To</label>
                        <input type="date" class="form-control" name="date_to" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Issuance Type</label>
                        <select class="form-select" name="issuance_type">
                            <option value="all">All Types</option>
                            <option value="New">New</option>
                            <option value="Replacement">Replacement</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Site</label>
                        <select class="form-select" name="site">
                            <option value="all">All Sites</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">
                    <i class="fas fa-file-download"></i> Generate
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Delivery Report Modal -->
<div class="modal fade" id="deliveryReportModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-truck"></i> Generate Delivery Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="deliveryReportForm">
                    <div class="mb-3">
                        <label class="form-label">Date From</label>
                        <input type="date" class="form-control" name="date_from" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Date To</label>
                        <input type="date" class="form-control" name="date_to" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Supplier</label>
                        <select class="form-select" name="supplier">
                            <option value="all">All Suppliers</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Status</label>
                        <select class="form-select" name="status">
                            <option value="all">All Status</option>
                            <option value="Pending">Pending</option>
                            <option value="Partially Delivered">Partially Delivered</option>
                            <option value="Completed">Completed</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">
                    <i class="fas fa-file-download"></i> Generate
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    // Initialize Reports when page loads
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof init_reports === 'function') {
            init_reports();
        }
    });
</script>